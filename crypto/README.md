# CRYPTO

椭圆曲线加密算法（Elliptic Curve Cryptography, ECC），是基于椭圆曲线数学理论实现的一种非对称加密算法。
相比 RSA，ECC 优势是可以使用更短的密钥，来实现与 RSA 相当或更高的安全。
> **RSA** 算法是一种非对称加密算法。

## ECC

### 椭圆曲线加解密算法原理

设私钥、公钥分别为***d***、***Q***，即 `Q = dG`，其中 ***G*** 为基点，椭圆曲线上的已知 ***Q*** 和
***G***，求 ***d*** 是非常困难的，也就是说已知公钥和基点，想要算出私钥是非常困难的。

**公钥加密**：选择随机数 *r*，将消息M生成密文 *C*，该密文是一个点对，`C = {rG, M+rQ}`，其中 ***Q*** 为公钥。

**私钥解密**：`M + rQ - d(rG) = M + r(dG) - d(rG) = M`，其中 ***d***、***Q*** 分别为私钥、公钥。

### 椭圆曲线签名算法原理

**私钥签名**

+ 选择随机数 r，计算点 `rG(x, y)`。
+ 根据随机数 r、消息 M 的哈希 h、私钥 d，计算 `s = (h + dx)/r`。
+ 将消息 M、和签名 `{rG, s}` 发给接收方。

**公钥验签**

+ 接收方收到消息 M、以及签名 `{rG=(x,y), s}`。
+ 根据消息求哈希 h。
+ 使用发送方公钥 Q 计算：`hG/s + xQ/s`，并与 rG 比较，如相等即验签成功。
+ 原理：`hG/s + xQ/s = hG/s + x(dG)/s = (h+xd)G/s = r(h+xd)G / (h+dx) = rG`

### Secp256k1

椭圆曲线加密算法中的曲线。

**特点**

+ 应用广泛，尤其在比特币和其他加密货币中。
+ 基于 Koblitz 曲线，使用的参数是随机的。
+ 公钥和私钥生成效率高，验证速度快。
+ 采用的曲线方程为：y<sup>2</sup> = x<sup>3</sup> + 7。

### Sm2p256v1

椭圆曲线加密算法中的曲线。

**特点**

+ 由中国国家密码管理局设计的，符合中国国家标准（GB/T 32918-2016）。
+ 被广泛用于中国的加密标准和应用中。
+ 与NIST P-256曲线相似，使用的参数是确定的。
+ 采用的曲线方程为：y<sup>2</sup> = x<sup>3</sup> + ax + b，其中参数 a 和 b 由标准规定。

### Public Key

在ECC中，公钥的长度可以是 **64** 字节或 **65** 字节，具体取决于公钥的格式。以下是它们的主要区别：

+ <u>未压缩公钥</u>「**65** 字节」，包含一个前缀字节「**0x04**，表示未压缩公钥」，后面跟着两个32字节的坐标值「x和y」。
+ <u>压缩公钥</u>「**33** 字节」，包含一个前缀字节「**0x02** 或 **0x03**」，表示y坐标的奇偶性，后面跟着32字节的x坐标。

## KDF

密钥导出函数(Key derivation function, KDF)。

### 生成地址和密钥对

KDFs在区块链系统中用于从种子（seed）或助记词（mnemonic phrase）生成一系列密钥对和地址。例如，在比特币或以太坊中，BIP-32和BIP-39标准使用KDFs生成层级确定性钱包（HD
wallets），从而允许用户从一个种子生成多个密钥对。

## 名词

+ ECC, Elliptic Curve Cryptography: 椭圆曲线密码学
+ ECDSA, Elliptic Curve Digital Signature Algorithm: 椭圆曲线数字签名算法